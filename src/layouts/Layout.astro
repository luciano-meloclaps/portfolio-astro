---
// src/layouts/Layout.astro
import { SEO } from 'astro-seo';
import '@/styles/global.css';

// Fuentes locales
import '@fontsource-variable/inter';
import '@fontsource-variable/jetbrains-mono';

import ThemeManager from '@/components/modules/ThemeManager.astro';
import Navbar from '@/components/modules/Navbar.astro';
import MobileMenu from '@/components/modules/MobileMenu.astro';

interface Props {
  title?: string;
  description?: string;
  image?: string;
  canonicalURL?: string;
}

// CONFIGURACIÓN DE MARCA Y SEO
const fullName = 'Luciano Stefano Melo Claps';
const defaultTitle = `${fullName} | Software Developer`;
const defaultDescription = `${fullName} | Desarrollador Fullstack .NET & React. Soluciones de software escalables, UX/UI y optimización técnica. Conocé mi trayectoria.`;

const siteUrl = 'https://meloclaps.com';

const {
  title = defaultTitle,
  description = defaultDescription,
  image = '/og-image.jpg',
  canonicalURL = Astro.url.href,
} = Astro.props;

const ogImageUrl = new URL(image, siteUrl).href;

const personSchema = {
  '@context': 'https://schema.org',
  '@type': 'Person',
  name: fullName,
  url: siteUrl,
  image: ogImageUrl,
  sameAs: [
    'https://github.com/luciano-stefano-meloclaps',
    'https://linkedin.com/in/luciano-stefano-melo-claps',
  ],
  jobTitle: 'Software Developer',
  knowsAbout: ['.NET', 'React', 'Astro', 'TypeScript', 'UX/UI Design', 'SEO'],
  description: defaultDescription,
};
---

<!doctype html>
<html lang="es" class="scroll-smooth">
  <head>
    <!-- 1. Prioridad Crítica: Codificación y Viewport -->
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <meta name="generator" content={Astro.generator} />
    <meta name="theme-color" content="#000000" />

    <!-- 2. Identidad y Canonicidad -->
    <link rel="canonical" href={canonicalURL} />
    <link rel="icon" type="image/png" href="/favicon.png" sizes="32x32" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

    <!-- 3. SEO y Metadatos Sociales -->
    <SEO
      title={title}
      description={description}
      canonical={canonicalURL}
      openGraph={{
        basic: {
          title: title,
          type: 'website',
          image: ogImageUrl,
          url: canonicalURL,
        },
        image: {
          alt: `${fullName} - Portfolio`,
          width: 1200,
          height: 630,
        },
        optional: {
          siteName: `${fullName} Portfolio`,
          locale: 'es_AR',
        },
      }}
      twitter={{
        card: 'summary_large_image',
        title: title,
        description: description,
        image: ogImageUrl,
      }}
      extend={{
        meta: [
          { name: 'robots', content: 'index, follow' },
          { name: 'googlebot', content: 'index, follow' },
        ],
      }}
    />

    <!-- 4. Scripts Críticos (Theme) y Datos Estructurados -->
    <ThemeManager />
    <script
      type="application/ld+json"
      set:html={JSON.stringify(personSchema)}
    />
  </head>

  <body
    class="selection:bg-accent-magenta/30 overflow-x-hidden bg-background font-sans text-text-primary antialiased"
  >
    <!-- GRID GLOBAL -->
    <div
      class="pointer-events-none fixed inset-0 z-[-1]"
      style="
        background-size: 4.5rem 4.5rem;
        background-image: 
          linear-gradient(to right, rgb(var(--color-grid-line) / 0.05) 1px, transparent 1px),
          linear-gradient(to bottom, rgb(var(--color-grid-line) / 0.05) 1px, transparent 1px);
      "
      aria-hidden="true"
    >
    </div>

    <Navbar />
    <MobileMenu />

    <slot />
  </body>
</html>
